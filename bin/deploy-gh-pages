#!/usr/bin/env node

var exec = require('child_process').exec,
    step = require('step'),
    conf = require('../config');

process.chdir('../_deploy');

step(
    function gitAdd() {
        exec('git add .', function(err, stdout, stderr) {});
    },
    function gitAddU() {
        exec('git add -u', function(err, stdout, stderr) {});
    },
    function gitCommit() {
        var message = 'Site updated at '+ new Date();
        exec('git commit -m '+ message, function(err, stdout, stderr) {});
    },
    function gitPush() {
        exec('git push origin '+ conf.deployBranch +' --force', function(err, stdout, stderr) {});
    }
);
